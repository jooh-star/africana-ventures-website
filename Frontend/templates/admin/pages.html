{% extends "admin/base.html" %}

{% block title %}Page Photo Management{% endblock %}
{% block page_title %}Page Photo Management{% endblock %}
{% block page_description %}Manage photos for each website page{% endblock %}

{% block content %}
<div class="mb-6">
    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6">
        <div class="flex items-center mb-4">
            <i class="fas fa-info-circle text-blue-600 text-2xl mr-3"></i>
            <h3 class="text-lg font-semibold text-gray-900">Page-wise Photo Management</h3>
        </div>
        <p class="text-gray-700 mb-4">
            Manage photos organized by website pages. Each page has its own dedicated photo management interface 
            with sections specific to that page's layout and content requirements.
        </p>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
            <div class="flex items-center text-green-700">
                <i class="fas fa-check-circle mr-2"></i>
                <span>Organized by page structure</span>
            </div>
            <div class="flex items-center text-blue-700">
                <i class="fas fa-layer-group mr-2"></i>
                <span>Section-based organization</span>
            </div>
            <div class="flex items-center text-purple-700">
                <i class="fas fa-tags mr-2"></i>
                <span>Contextual photo management</span>
            </div>
        </div>
    </div>
</div>

<!-- Page Cards Grid -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for page in pages %}
    {% set stats = page_stats.get(page, {}) %}
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
        <!-- Page Header -->
        <div class="bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200">
            <div class="flex items-center justify-between">
                <h3 class="text-lg font-semibold text-gray-900 capitalize flex items-center">
                    {% if page == 'index' %}
                        <i class="fas fa-home mr-3 text-blue-600"></i>
                        Homepage
                    {% elif page == 'about' %}
                        <i class="fas fa-info-circle mr-3 text-green-600"></i>
                        About Us
                    {% elif page == 'services' %}
                        <i class="fas fa-cogs mr-3 text-purple-600"></i>
                        Services
                    {% elif page == 'products' %}
                        <i class="fas fa-box mr-3 text-orange-600"></i>
                        Products
                    {% elif page == 'contact' %}
                        <i class="fas fa-envelope mr-3 text-red-600"></i>
                        Contact
                    {% elif page == 'solutions' %}
                        <i class="fas fa-lightbulb mr-3 text-yellow-600"></i>
                        Solutions
                    {% endif %}
                </h3>
                <span class="text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full font-medium">
                    {{ page }}
                </span>
            </div>
        </div>
        
        <!-- Statistics -->
        <div class="p-6">
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="text-center">
                    <div class="text-2xl font-bold text-gray-900">{{ stats.get('total_images', 0) }}</div>
                    <div class="text-sm text-gray-500">Total Images</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-green-600">{{ stats.get('active_images', 0) }}</div>
                    <div class="text-sm text-gray-500">Active</div>
                </div>
            </div>
            
            <!-- Additional Stats -->
            <div class="space-y-3">
                <div class="flex items-center justify-between text-sm">
                    <span class="text-gray-600 flex items-center">
                        <i class="fas fa-star mr-2 text-yellow-500"></i>
                        Featured Images
                    </span>
                    <span class="font-medium text-gray-900">{{ stats.get('featured_images', 0) }}</span>
                </div>
                
                {% if stats.get('sections') %}
                <div class="text-sm">
                    <span class="text-gray-600 flex items-center mb-2">
                        <i class="fas fa-layer-group mr-2 text-blue-500"></i>
                        Sections ({{ stats.get('sections')|length }})
                    </span>
                    <div class="flex flex-wrap gap-1">
                        {% for section in stats.get('sections', [])[:3] %}
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                            {{ section|title }}
                        </span>
                        {% endfor %}
                        {% if stats.get('sections')|length > 3 %}
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-200 text-gray-600">
                            +{{ stats.get('sections')|length - 3 }} more
                        </span>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
        
        <!-- Action Buttons -->
        <div class="px-6 py-4 bg-gray-50 border-t border-gray-200">
            <div class="flex items-center justify-between space-x-3">
                <a href="{{ url_for('admin.admin_page_photos', page_name=page) }}" 
                   class="flex-1 inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors">
                    <i class="fas fa-images mr-2"></i>
                    Manage Photos
                </a>
                <a href="{{ url_for('admin.upload_page_photo', page_name=page) }}" 
                   class="inline-flex items-center px-4 py-2 border border-gray-300 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors"
                   title="Upload New Photo">
                    <i class="fas fa-plus"></i>
                </a>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- Quick Actions -->
<div class="mt-8 bg-white rounded-xl shadow-sm border border-gray-200 p-6">
    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
        <i class="fas fa-bolt mr-3 text-yellow-600"></i>
        Quick Actions
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <a href="{{ url_for('admin.admin_images') }}" 
           class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
            <i class="fas fa-th-large text-gray-400 mr-3"></i>
            <div>
                <div class="font-medium text-gray-900">View All Images</div>
                <div class="text-sm text-gray-500">Global image management</div>
            </div>
        </a>
        <a href="{{ url_for('admin.populate_initial_image_data') }}" 
           class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
            <i class="fas fa-database text-gray-400 mr-3"></i>
            <div>
                <div class="font-medium text-gray-900">Populate Initial Data</div>
                <div class="text-sm text-gray-500">Add sample image records</div>
            </div>
        </a>
        <a href="{{ url_for('admin.migrate_sections') }}" 
           class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
            <i class="fas fa-sync-alt text-gray-400 mr-3"></i>
            <div>
                <div class="font-medium text-gray-900">Migrate Sections</div>
                <div class="text-sm text-gray-500">Update sections to match frontend templates</div>
            </div>
        </a>
        <div class="flex items-center p-4 border border-gray-200 rounded-lg bg-gray-50">
            <i class="fas fa-chart-bar text-gray-400 mr-3"></i>
            <div>
                <div class="font-medium text-gray-900">Total: {{ page_stats.values() | sum(attribute='total_images') if page_stats else 0 }} Images</div>
                <div class="text-sm text-gray-500">Across all pages</div>
            </div>
        </div>
    </div>
</div>
{% endblock %}